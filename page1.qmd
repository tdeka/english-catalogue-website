---
title: "Publications by Format & Year"
format: html
---

<h1 class="page-top">Publications by Format & Year</h1>

```{python}
#| echo: false
import pandas as pd
import plotly.graph_objects as go

# Load data
df = pd.read_csv("top_format.csv")

# Pivot data
pivot_df = df.pivot_table(
    index="year",
    columns="format",
    values="num_entry",
    aggfunc="sum",
    fill_value=0,
).sort_index()

# Create traces and buttons
buttons = []
for col in pivot_df.columns:
    buttons.append(dict(
        label=col,
        method="update",
        args=[
            {"visible": [c == col for c in pivot_df.columns]},
            {"title": f"Publications for Format: {col} (1912â€“1922)",
             "barmode": "group"}
        ]
    ))

# Add "All formats" button first
buttons.insert(0, dict(
    label="All formats",
    method="update",
    args=[
        {"visible": [True] * len(pivot_df.columns)},
        {"title": "Top Formats by Number of Publications (1912â€“1922)",
         "barmode": "stack"}
    ]
))

# Create initial stacked bar chart
fig = go.Figure()
for col in pivot_df.columns:
    fig.add_trace(go.Bar(x=pivot_df.index, y=pivot_df[col], name=col))

# Update layout to move dropdown to the LEFT
fig.update_layout(
    xaxis_title="Year",
    yaxis_title="Number of Publications",
    barmode="stack",
    updatemenus=[dict(
        active=0,
        buttons=buttons,
        direction="down",
        showactive=True,
        x=0,                 # ðŸ‘ˆ align to left edge
        xanchor="left",      # ðŸ‘ˆ anchor to left
        y=1.15,
        yanchor="top"
    )]
)

fig.show()


```